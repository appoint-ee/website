name: AppointeeWeb

on:
  push:
    branches: [ "development" ]
  pull_request:
    branches: [ "development" ]

jobs:

  deploy:

    runs-on: ubuntu-latest


    steps:
    - name: Install kubectl
      uses: digitalocean/action-doctl@v2
      with:
        token: ${{ secrets.K8S_ACCESS_TOKEN }}
        args: kubectl version --client
    - name: Configure kubectl
      run: |
        mkdir -p ~/.kube
        echo "$KUBE_CONFIG" > ~/.kube/config
    - name: Copy deployment.yaml
      run: ls

    - name: Copy deployment.yaml
      run: pwd

    - name: Deploy to DigitalOcean Kubernetes
      run: |
        kubectl apply -f $HOME/deployment.yaml
